#summary How to deploy your course code to Google production servers.

<h1>Deploy Your App to Google </h1>

Do not do this step until you are ready for your code to go live in production; that is, until you are ready for members of your audience to see your course.

If you want to see what your app looks like in production, you can deploy it to Google. When traffic comes to your app, App Engine servers start up an instance running your app and enable access to it from its default URL of _*{{{APP_ID}}}*_{{{.appspot.com}}} to handle requests, where  _*{{{APP_ID}}}*_ is the app name you specified in [GetCode#2._Decide_on_a_name_for_your_app Run the sample app]. 

The first time you deploy your app, there are three steps:
<wiki:toc max_depth="2" />

If you make changes and need to redeploy your app, you do not need to repeat the first step. You may need to repeat the second step. (Details below.)

== Register your app with Google ==

Before you can deploy (or upload) an application to Google, you must register that app with Google.  Before you can register an app with Google, you must have a Google account. If you do not have a Google account, you can [https://www.google.com/settings/account create a Google account] with an email address and password.

Once you have a Google account, you can start registering your application in two ways:

  * From a web  browser, navigate to https://appengine.google.com/
  * From the App Engine Launcher, click on *Dashboard*.

Both of these get you to the same place.

If you are not currently logged in to your Google account, you're brought to a login screen. Once you login, you are brought to your App Engine dashboard. If you've never worked on an App Engine app, your dashboard will look as follows:

https://www.corp.google.com/~vpg/no_crawl/cb/dashboard.png

Click on *Create Application* and follow the instructions for verifying your account. After this process, you see the new application screen:

https://www.corp.google.com/~vpg/no_crawl/cb/new-application.png

To create a new application, follow the instructions to register an application ID, a name unique to this application. If you elect to use the free appspot.com domain name, the full URL for the application will be {{{http://}}}_*{{{APP_ID}}}*_{{{.appspot.com/}}}. You can also purchase a top-level domain name for your app, or use one that you have already registered.

*Important:* The app ID you register for your app *must* be the app ID in your {{{app.yaml}}} file. If you register a different ID than you use in development, you must change {{{app.yaml}}} before deploying your app. We strongly suggest that you use the same app ID in both development and in production.

== Set up an app-specific password ==

Course Builder uses 2-step authentication to ensure the security of your courses. This means that to deploy your application, it is not good enough to provide the standard password that goes with your username. You must insted supply a password that is specific to this application. See [http://support.google.com/accounts/bin/answer.py?hl=en&answer=185833 Signing in using application-specific passwords] for information on how to create your app-specific password.

Keep the password you generate visible. You'll need to use it three times in the next step.


== Upload (or deploy) your app ==

Once you register your app, the most straightforward way to deploy your application is from a Unix command-line shell. From the shell:

  {{{$ cd }}}_*{{{APPPATH}}}*_<br>
  {{{$ appcfg.py update .}}}<br>
  {{{$ }}}<br>
  {{{$ cd data}}}<br>
  {{{$ appcfg.py upload_data --url=http://}}}_*{{{APP_ID}}}*_{{{.appspot.com/_ah/remote_api --config_file=../bulkloader.yaml  --filename=unit.csv --kind=Unit}}}<br>
  {{{$ appcfg.py upload_data --url=http://}}}_*{{{APP_ID}}}*_{{{.appspot.com/_ah/remote_api --config_file=../bulkloader.yaml  --filename=lesson.csv --kind=Lesson}}}

where _*{{{APP_ID}}}*_ is the app ID you registered for your app.

You will be asked to supply your credentials. Supply your username and the app-specific password you created in the previous step.

It can take up to a minute to deploy your app; generally it's less than 30 seconds but usually not more than a minute. Once the deploy completes and confirms, you (and everyone else on the planet not blocked from Google) can visit {{{http://}}}_*{{{APP_ID}}}*_{{{.appspot.com}}} and verify that your app is indeed available to all.

== (Alternative) Upload without a Password ==

In general, every time you make a change that causes you to redeploy your app to production, you need a new app-specific password to use when uploading your app. You may choose to avoid this, by giving App Engine access to your account. 

Before you choose to do so, please read [https://developers.google.com/appengine/docs/python/tools/uploadinganapp#oauth Passwordless Login with OAuth2], so that you can understand the risks involved.

To upload your application without supplying your credentials:

<font color=red><<TODO this doesn't work for me. The update does, but the upload_data lines still ask for credentials. I wonder what I'm doing wrong?>></font>

  {{{$ cd }}}_*{{{APPPATH}}}*_<br>
  {{{$ appcfg.py --oauth2 update .}}}<br>
  {{{$ }}}<br>
  {{{$ cd data}}}<br>
  {{{$ appcfg.py --oauth2 upload_data --url=http://}}}_*{{{APP_ID}}}*_{{{.appspot.com/_ah/remote_api --config_file=../bulkloader.yaml  --filename=unit.csv --kind=Unit}}}<br>
  {{{$ appcfg.py --oauth2 upload_data --url=http://}}}_*{{{APP_ID}}}*_{{{.appspot.com/_ah/remote_api --config_file=../bulkloader.yaml  --filename=lesson.csv --kind=Lesson}}}

where _*{{{APP_ID}}}*_ is the app ID you registered for your app.